scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Embryonic Cell Lines")
p
p <- ggplot(data= scaled_df, mapping = aes_string(y = 'cell_line', x = 'cell_types')) +
geom_tile(mapping = aes_string(fill = 'top_cat')) +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Cell Lines'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Embryonic Cell Lines")
ggsave(filename = file.path(TARGET_dir, "Cell_lines_top.png"), plot = p, width = 15, height = 4)
##### plotting out the cell line results #####
adult_tissue = combination_df[grepl("RNA.Seq_Profile_FlyAtlas2_", combination_df$cell_lines), ]
adult_tissue$tissue = stringr::str_remove_all(adult_tissue$cell_lines, "RNA.Seq_Profile_FlyAtlas2_")
adult_tissue$tissue = stringr::str_remove_all(adult_tissue$tissue, "_\\..*")
adult_tissue = scale_correlation_df(adult_tissue)
exclude_list = c("Head", "Crop", "Carcass", "Whole", 'Eye', 'AccessoryGland', 'Spermathecum')
for(bad_ct in exclude_list) {
adult_tissue = adult_tissue[grepl(bad_ct, adult_tissue$tissue) == FALSE, ]
}
p <- ggplot(data= adult_tissue, mapping = aes_string(y = 'tissue', x = 'cell_types')) +
geom_tile(mapping = aes_string(fill = 'scale_spearman_correlation')) +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_colourbar(title = 'Scaled Spearman Correlation')) +
scale_fill_viridis_c(option = "plasma") +
labs(
x = '',
y = 'Adult Tissues'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Adult Tissues")
ggsave(filename = file.path(TARGET_dir, "adult_tissues.png"), plot = p, width = 15, height = 10)
ggsave(filename = file.path(TARGET_dir, "adult_tissues.png"), plot = p, width = 15, height = 8)
ggsave(filename = file.path(TARGET_dir, "adult_tissues.png"), plot = p, width = 15, height = 5)
adult_tissue$top_cat = 'Other'
adult_tissue[adult_tissue$scale_spearman_correlation == 1, 'top_cat'] = "Top Cell Type"
p <- ggplot(data= adult_tissue, mapping = aes_string(y = 'tissue', x = 'cell_types')) +
geom_tile(mapping = aes_string(fill = 'top_cat')) +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Cell Lines'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Embryonic Cell Lines")
p
p <- ggplot(data= adult_tissue, mapping = aes_string(y = 'tissue', x = 'cell_types')) +
geom_tile(mapping = aes_string(fill = 'top_cat'),
color = "white",
lwd = 1.5,
linetype = 1) +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Cell Lines'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Embryonic Cell Lines")
p <- ggplot(data= adult_tissue, mapping = aes_string(y = 'tissue', x = 'cell_types')) +
geom_tile(mapping = aes_string(fill = 'top_cat'),
color = "white",
lwd = 1.5,
linetype = 1) +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Cell Lines'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Embryonic Cell Lines")
p
p <- ggplot(data= adult_tissue, mapping = aes_string(y = 'tissue', x = 'cell_types')) +
geom_tile(mapping = aes(fill = top_cat),
color = "white",
lwd = 1.5,
linetype = 1) +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Cell Lines'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Embryonic Cell Lines")
p
p <- ggplot(data= adult_tissue, aes = (y = tissue, x = cell_types, fill = top_cat)) +
p <- ggplot(data= adult_tissue, aes = (y = tissue, x = cell_types, fill = top_cat)) +
p <- ggplot(data= adult_tissue, aes(y = tissue, x = cell_types, fill = top_cat)) +
geom_tile(color = "white",
lwd = 1.5,
linetype = 1) +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Cell Lines'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Embryonic Cell Lines")
p
p <- ggplot(data= adult_tissue, aes(y = tissue, x = cell_types, fill = top_cat)) +
geom_tile() +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Cell Lines'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Embryonic Cell Lines")
p
p <- ggplot(data= adult_tissue, aes(y = tissue, x = cell_types, fill = top_cat)) +
geom_tile(color = "white",
lwd = 1.5,
linetype = 1) +
coord_fixed() +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Cell Lines'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Embryonic Cell Lines")
p
p <- ggplot(data= adult_tissue, aes(y = tissue, x = cell_types, fill = top_cat)) +
geom_tile(color = "white",
lwd = 1.5,
linetype = 1) +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Cell Lines'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Embryonic Cell Lines")
p
p <- ggplot(data= adult_tissue, aes(y = tissue, x = cell_types, fill = top_cat)) +
geom_tile(color = "white") +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Cell Lines'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Embryonic Cell Lines")
p
p <- ggplot(data= adult_tissue, aes(y = tissue, x = cell_types, fill = top_cat)) +
geom_tile(color = "black") +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Cell Lines'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Embryonic Cell Lines")
p
p <- ggplot(data= adult_tissue, aes(y = tissue, x = cell_types, fill = top_cat)) +
geom_tile(color = "black") +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Adult Tissue'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Adult Tissues")
ggsave(filename = file.path(TARGET_dir, "Adult_tissue_top.png"), plot = p, width = 15, height = 4)
##### plotting out the cell line results #####
adult_tissue = combination_df[grepl("RNA.Seq_Profile_FlyAtlas2_", combination_df$cell_lines), ]
adult_tissue$tissue = stringr::str_remove_all(adult_tissue$cell_lines, "RNA.Seq_Profile_FlyAtlas2_")
adult_tissue$tissue = stringr::str_remove_all(adult_tissue$tissue, "_\\..*")
adult_tissue = scale_correlation_df(adult_tissue)
exclude_list = c("Head", "Crop", "Carcass", "Whole", 'Eye', 'AccessoryGland', 'Spermathecum', 'Heart')
for(bad_ct in exclude_list) {
adult_tissue = adult_tissue[grepl(bad_ct, adult_tissue$tissue) == FALSE, ]
}
p <- ggplot(data= adult_tissue, mapping = aes_string(y = 'tissue', x = 'cell_types')) +
geom_tile(mapping = aes_string(fill = 'scale_spearman_correlation')) +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_colourbar(title = 'Scaled Spearman Correlation')) +
scale_fill_viridis_c(option = "plasma") +
labs(
x = '',
y = 'Adult Tissues'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Adult Tissues")
ggsave(filename = file.path(TARGET_dir, "adult_tissues.png"), plot = p, width = 15, height = 5)
adult_tissue$top_cat = 'Other'
adult_tissue[adult_tissue$scale_spearman_correlation == 1, 'top_cat'] = "Top Cell Type"
p <- ggplot(data= adult_tissue, aes(y = tissue, x = cell_types, fill = top_cat)) +
geom_tile(color = "black") +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Adult Tissue'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Adult Tissues")
ggsave(filename = file.path(TARGET_dir, "Adult_tissue_top.png"), plot = p, width = 15, height = 4)
ggsave(filename = file.path(TARGET_dir, "Adult_tissue_top.png"), plot = p, width = 15, height = 5)
##### plotting out the cell line results #####
adult_tissue = combination_df[grepl("RNA.Seq_Profile_FlyAtlas2_", combination_df$cell_lines), ]
adult_tissue$tissue = stringr::str_remove_all(adult_tissue$cell_lines, "RNA.Seq_Profile_FlyAtlas2_")
adult_tissue$tissue = stringr::str_remove_all(adult_tissue$tissue, "_\\..*")
adult_tissue = scale_correlation_df(adult_tissue)
exclude_list = c("Head", "Crop", "Carcass", "Whole", 'Eye', 'AccessoryGland', 'Spermathecum')
for(bad_ct in exclude_list) {
adult_tissue = adult_tissue[grepl(bad_ct, adult_tissue$tissue) == FALSE, ]
}
p <- ggplot(data= adult_tissue, mapping = aes_string(y = 'tissue', x = 'cell_types')) +
geom_tile(mapping = aes_string(fill = 'scale_spearman_correlation')) +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_colourbar(title = 'Scaled Spearman Correlation')) +
scale_fill_viridis_c(option = "plasma") +
labs(
x = '',
y = 'Adult Tissues'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Adult Tissues")
ggsave(filename = file.path(TARGET_dir, "adult_tissues.png"), plot = p, width = 15, height = 5)
adult_tissue$top_cat = 'Other'
adult_tissue[adult_tissue$scale_spearman_correlation == 1, 'top_cat'] = "Top Cell Type"
p <- ggplot(data= adult_tissue, aes(y = tissue, x = cell_types, fill = top_cat)) +
geom_tile(color = "black") +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Adult Tissue'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Adult Tissues")
ggsave(filename = file.path(TARGET_dir, "Adult_tissue_top.png"), plot = p, width = 15, height = 5)
p
p <- ggplot(data= adult_tissue, aes(y = cell_line, x = cell_types, fill = top_cat)) +
geom_tile(color = "black") +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Cell Lines'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Embryonic Cell Lines")
p
p <- ggplot(data= scaled_df, aes(y = cell_line, x = cell_types, fill = top_cat)) +
geom_tile(color = "black") +
#scale.func(range = c(0, 100), limits = c(scale.min, scale.max)) +
guides(fill = guide_legend(title = 'Top Correlated Cell Type')) +
scale_fill_brewer(palette = 'Set2') +
labs(
x = '',
y = 'Embryonic Cell Lines'
) +
theme_classic()  +
facet_grid(
cols = vars(stages),
scales = "free_x",
space = "free_x",
switch = "y"
) +
theme(
panel.spacing = unit(x = 1, units = "lines"),
strip.background = element_blank()
) +
theme(strip.text.x = element_blank(), axis.text.x=element_text(angle=45, vjust = 1, hjust=1)) +
ggtitle("Drosophila Embryonic Cell Lines")
o
p
ggsave(filename = file.path(TARGET_dir, "Cell_lines_top.png"), plot = p, width = 15, height = 4)
ggsave(filename = file.path(TARGET_dir, "Cell_lines_top.png"), plot = p, width = 15, height = 3)
View(combination_df)
combination_df = read.csv(file.path(TARGET_dir, 'spearman_correlation_cl_ct.csv'), row.names = 1)
View(combination_df)
big_avg_tab = readRDS(file.path(TARGET_Dir, "avg_tab_wt13.rds"))
big_avg_tab = readRDS(file.path(TARGET_dir, "avg_tab_wt13.rds"))
dim(big_avg_tab)
length(unique(adult_tissue$tissue))
